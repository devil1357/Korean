# 目录 

简介 

- Power BI 

    - 任务 1：自动创建报表 

    - 任务 2：隐藏默认（指标）表

    - 任务 3：为新报表配置背景

    - 任务 4：向报表中添加标头

    - 任务 5：向报表中添加 KPI

    - 任务 6：向报表中添加折线图

    - 任务 7：配置 Date 表中的 Year 列

    - 任务 8：在 Date 表中配置 Short_Month_Name 列

    - 任务 9：设置折线图的格式

    - 任务 10：添加新数据以模拟 Direct Lake 模式

清理实验环境 

参考 

# 简介

我们已将来自不同数据源的数据引入 Lakehouse，创建数据模型，并为数据源设置刷新计划。我们接下来创建报表。

本实验结束后，您将学会：

-  如何自动创建报表

-  如何从空白画布开始生成报表

-  如何体验 Direct Lake 模式以自动刷新数据

# Power BI

### 任务 1：自动创建报表

我们先使用自动创建报表选项。稍后在实验中，我们将重新创建 Power BI 中的报表。

1. 我们导航回到您在之前的实验中创建的 **Fabric 工作区**。

2. 您可能位于 Data Factory 主页。在左侧面板底部选择 **Data Factory 图标**。

3. Fabric 体验对话框随即打开。选择 **Power BI**。您将导航到 **Power BI 主页**。

4. 从顶部菜单中选择**新建报告**。

5. 您将导航到**生成第一个报表屏幕**。可以选择手动输入数据并生成报表，或选择已发布的语义模型。我们在之前的实验中创建了一个语义模型。我们来使用该模型。选择**选择发布的语义模型**选项。

6. "选择要在报表中使用的数据集"页面随即打开。请注意，我们有四个选项。**选择 lh_FAIAD**：

    a. **lh_FAIAD：** 这是 Lakehouse，其中包含我们创建并希望用于报表的数据集。

    b. **Units by Supplier：** 这是我们使用 T-SQL 创建的数据集。

    c. **DataflowsStagingWarehouse：** 这是默认创建的暂存仓库，因为我们没有暂存数据，所以没有使用它。

    d. **DataflowsStagingLakehouse：** 这是默认创建的暂存 lakehouse，因为我们没有暂存数据，所以没有使用它。

7. 点击 **"自动创建报表"按钮旁边的箭头**。请注意，有两个选项："自动创建报表"和"创建空白报表"。我们来尝试自动创建报表，因此选择**自动创建报表**。

8. Power BI 将开始自动创建报表。请注意，您可以选择此处的"预先选择数据"选项。报表准备好后，屏幕右上角会出现一个对话框。选择**立即查看报表**。

**检查点：** 您将得到一份与下面的屏幕截图相似的报表。有一些 KPI 和一些趋势视觉图。如果您要分析新模型并需要快速启动，可以从这里入手。

**注意：** 请注意，在顶部菜单上，您可以选择"编辑报表"或以表的形式查看某些数据。请自行浏览这些选项。

9. 准备就绪后，**折叠**右侧**数据**部分中的所有表。请注意，我们有五个新表，它们不属于我们创建的模型的一部分。这些是为了帮助分析性能而添加的默认表。我们稍后会从报表视图中删除这些表。

10. 我们保存该报表。从顶部菜单中选择**保存**。

11. "保存报表"对话框随即打开。将报表命名为 **rpt_Sales_Auto_Report**

**注意：** 我们在报表名称前加上 rpt（报表的缩写）作为前缀。

12. 确保将报表保存在 **\<您的工作区名称\>中。**

13. 选择**保存。**

### 任务 2：隐藏默认（指标）表

我们现在创建一个类似于 Power BI Desktop 中的报表。我们将使用空白画布完成此任务。在开始创建报表之前，我们从报表视图中删除默认表（上方屏幕截图所示）。这是在 Lakehouse 的建模部分完成的。

1. 在左侧面板底部选择 **Power BI 图标**。Fabric 对话框随即打开。

2. 选择 **Data Engineering**。您将导航到 Data Engineering 主页。

3. 向下滚动到**快速访问**部分。

4. 选择 **lh_FAIAD -\> SQL 分析终结点**。我们将进入 Lakehouse 的数据视图。

5. 从**左侧面板底部**，选择**模型**以导航到模型视图。

请注意，在设计画布上可以找到默认表。（您可能需要滚动到右侧或底部才能看到它们）

6. 右键单击表 **long_running_queries**，选择**在报表视图中隐藏**。

7. 同样，为以下表选择**在报表视图中隐藏**选项：

    a. fabric_query_starting

    b. fabric_query_completed

    c. exec_requests_history

    d. frequently_run_queries

### 任务 3：为新报表配置背景

1. 我们可以先从模型视图创建新报表。从顶部菜单中，选择**主页 -\> 新建报告**。您将导航到浏览器新窗口/选项卡中的 Power BI 报表画布。

2. 如果您还未打开 **FAIAD.pbix**，请打开它。它位于您的实验环境**桌面**的 **Report** 文件夹中。

我们将使用这份报表作为参考。先添加画布背景。我们将创建报表标头，添加几个 KPI，并创建随时间变化的销售额折线图。为了节省时间，并且鉴于您具有在 Power BI Desktop 中生成视觉对象的经验，我们不会创建所有视觉对象。

3. 在浏览器中导航到 **Power BI 画布**。

4. 在"可视化"窗格中，选择**设置页面格式图标**。

5. 展开**画布背景部分**。

6. 从**图像**选项中选择**浏览**。"文件资源管理器"对话框随即打开。

7. 导航到实验环境的**桌面**上的**报表**文件夹。

8. 选择 **Summary Background.png。**

9. 将**图像匹配度**下拉菜单设置为**正常**。

10. 然后将透明度设置为 **0%**。

### 任务 4：向报表中添加标头

1. 我们在上边距中添加标头。从**菜单**中选择**文本框**。

2. 在文本框的第一行输入 **Fabrikam Company**。

3. 在文本框的第二行输入 **Sales Report**。

4. 突出显示 **Fabrikam Company**，并将**字体**设置为 **Segoe UI**，**字体大小**设置为 **18，粗体**。

5. 突出显示 **Sales Report**，并将**字体**设置为 **Segoe UI**，**字体大小**设置为 **14。**

6. **选中文本框**后，在右侧的格式窗格中，**展开效果**。

7. 使用**背景**滑块将其设置为**关闭**。

8. 调整**文本框的大小以适合上边距**。

### 任务 5：向报表中添加 KPI

1. 我们添加销售 KPI。选择画布中的**空白区域**，以将焦点从文本框上移开。

2. 从**可视化部分**，选择**多行卡视觉对象**。

3. 从**数据部分**展开 **Sales 表**。

4. 选择 **Sales 度量**。

5. 选择**多行卡视觉对象**后，从"可视化"部分选择**设置视觉对象格式图标**。

6. 展开**类别标签**部分。

7. 将**字体大小**增大到 **14**。

8. 选择**颜色下拉列表**。调色板对话框随即打开。

9. 将十六进制值设置为 **#004753**。

10. 展开**卡**部分。

11. 使用**强调栏**滑块将其设置为**关闭**。

12. 在"可视化"窗格中选择**常规**。

13. 展开**效果部分**。

14. 使用**背景**滑块将其设置为**关闭**。

15. 对**视觉对象**调整大小，并将其移到**左侧框，如屏幕截图所示**。

16. 我们再添加一个 KPI。选择我们刚刚创建的 **Sales 多行卡片**。通过从键盘中选择 **Ctrl+C** 来**复制**视觉对象。

17. 通过从键盘中选择 **Ctrl+V** 来**粘贴**视觉对象。请注意，视觉对象已粘贴到画布上。

18. **突出显示新视觉对象**后，在**可视化窗格 -\> 生成视觉对象 -\> 字段** 部分删除 **Sales** 度量。

19. 从**数据**部分展开 **Sales** 表，并选择 **Units** 度量。

20. 对**视觉对象**调整大小，并将其**放置在 Sales 视觉对象下方的框中**。

### 任务 6：向报表中添加折线图

我们创建一个折线图来可视化经销商公司随时间变化的销售额。

1. 选择画布中的**空白区域**，以将焦点从多行卡片视觉对象上移开。

2. 在**可视化部分**中选择**折线图**。

3. 从**数据部分**展开 **Date** 表。

4. 选择 **Year** 字段。请注意，Year 默认为求和值并添加到 Y 轴。我们来更正一下吧。

### 任务 7：配置 Date 表中的 Year 列

1. 导航到 **Lakehouse 模型视图**的浏览器选项卡。

2. 从左侧 Explorer 窗格中，展开 **lhFAIAD -\> Schemas -\> dbo -\> Tables -\> Date**。

3. 选择 **Year** 列。

4. 在右侧**属性**窗格中，展开**高级**部分。

5. 在**汇总依据**下拉列表中，选择**无**。

6. 导航回到 **Power BI 画布**的浏览器选项卡。

7. 从顶部菜单中选择**刷新**。请注意，现在 Year 不是求和字段。

8. 选择**折线图视觉对象**后，从 Y 轴**删除 Year 的总和**。

9. 选择 **Year** 字段，它将添加到 **X 轴**。

10. 展开 **Sales** 表，并选择 **Sales 度量**。

### 任务 8：在 Date 表中配置 Short_Month_Name 列

1. 我们向该图表添加月份。从 Date 表中，将 **Short_Month_Name** 字段拖到 **X 轴**中的 **Year** 下方。请注意，视觉对象是按 Sales 排序的。我们将其按 Short_Month_Name 排序。

2. 选择视觉对象右上角的**省略号 (...)**。

3. 选择**排序列 -\> Year Short_Month_Name**。

4. 选择视觉对象右上角的**省略号 (...)**。

5. 选择**排列轴 -\> 以升序排序**。

**注意：** 月份按字母顺序排序。让我们来解决这个问题。

6. 导航到 **Lakehouse 模型视图**的浏览器选项卡。

7. 从左侧 Explorer 窗格中，展开 **lhFAIAD -\> Schemas -\> dbo -\> Tables -\> Date**。

8. 选择 **Short_Month_Name** 列。

9. 在右侧**属性**窗格中，展开**高级**部分。

10. 在**按列排序**下拉列表中，选择 **Month**。

11. 导航回到 **Power BI 画布**的浏览器选项卡。

12. 从顶部菜单中选择**刷新**。请注意，现在月份已正确排序。

### 任务 9：设置折线图的格式

请注意，在生成报表时，更新语义模型很容易。这实现了像 Power BI Desktop 一样的无缝交互。

1. **选择折线图视觉对象**后，在**数据部分**，展开 **Reseller** 表。

2. 将 **Reseller -\> Reseller Company** 字段拖到**图例**部分。

3. **选择折线图视觉对象**后，从**可视化**部分选择**设置视觉对象格式图标 -\> 常规**。

4. 展开**标题**部分。

5. 将**标题**文本设置为 **Sales over time**。

6. 展开**效果**部分。

7. 使用**背景**滑块将其设置为**关闭**。

8. 在**可视化**部分中，选择**设置视觉对象格式图标 -\> 视觉对象**。

9. 展开 **X 轴**部分。

10. 使用**标题**滑块将其设置为**关闭**。

11. 展开**行**部分。

12. 展开**颜色**部分。

13. 将 **Wingtip Toys** 颜色设置为 **#004753**

14. 将 **Tailspin Toys** 颜色设置为 **#F17925**

15. 对**视觉对象**调整大小，并将其移到**右上方框，如屏幕截图所示**。

16. 滚动到视觉对象的右侧，**请注意，我们拥有截至 2023 年 4 月的数据**。

17. 我们保存报表，从菜单中选择**文件 -\> 保存**。

18. "保存报表"对话框随即打开。将报表命名为 **rpt_Sales_Report**

**注意：** 我们在报表名称前加上 rpt（报表的缩写）作为前缀。

19. 确保将报表保存在 **\<您的工作区名称\>中。**

20. 选择**保存。**

如前所述，我们不会在本实验中生成所有视觉对象。如果您有时间，可以自行生成更多视觉对象。

### 任务 10：添加新数据以模拟 Direct Lake 模式

在 Import 模式下，刷新源中的数据后，我们通常需要刷新 Power BI 模型，以更新报表中的数据。通过使用 Direct Query 模式，刷新源中的数据后，这些数据就可以在 Power BI 报表中使用。然而，direct query 模式通常很慢。为了解决这个问题，Microsoft Fabric 引入了 Direct Lake 模式。Direct Lake 是一种将数据从湖中直接加载到 Power BI 引擎中以供分析的快速路径。我们来探索一下。

在实际应用场景中，数据是在源进行更新的。由于我们处于训练环境中，因此我们在模拟时，将其连接到包含 2023 年 5 月数据的 parquet 文件。

1. 导航到 **Lakehouse 模型视图**的浏览器选项卡。

2. 从左侧面板中选择 **\<您的工作区名称\>**。

3. 选择 **df_Sales_ADFS**，以便我们可以通过添加新的 Parquet 文件来编辑数据流。

4. 如果您还未打开 **FAIAD.pbix**，请打开它。它位于您的实验环境**桌面**的 **Report** 文件夹中。

5. 从功能区中选择**主页 -\> 转换数据**。Power Query 窗口随即打开。

6. 从左侧面板的 **DirectLake** 文件夹下，选择 **MayInvoice** 查询。

7. **右键单击**并选择**复制。**

8. 导航回到浏览器中的**数据流屏幕**。

9. 在数据流窗格中，输入 **Ctrl+V**（目前不支持右键单击粘贴）。

现在，我们删除对 ADLS Base Folder (2) 的引用，并使用 ADLS Base Folder。

10. 选择 **MayInvoice** 查询。

11. 在右侧面板的**已应用步骤**下，选择 **Source**。

12. 在编辑栏中，将 **#"ADLS Base Folder (2)"** 更改为 **#"ADLS Base Folder"**

13. 选择编辑栏旁边的**复选标记**或按下 Enter 键。

14. 在左侧面板的"查询"部分下，**右键单击 ADLS Base Folder (2)** 查询，并选择**删除**。

15. "删除查询"对话框随即打开。选择**删除**进行确认。

16. 现在，我们将 5 月份的发票数据追加到 Invoice 表中。从"查询"部分选择 **Invoice** 查询。

17. 在功能区中，选择**主页 -\> 追加**查询。

18. "追加查询"对话框随即打开。从**要追加的表**下拉列表中，选择 **MayInvoice**。

19. 选择**确定**。

20. 在右下角，选择**发布**以保存和发布更新。

**注意：** 发布后，数据流将刷新。这可能需要几分钟的时间。

21. 导航回到 **Power BI 画布**的浏览器选项卡。

22. 从顶部菜单中选择**刷新**。请注意，折线图中现在有 2023 年 5 月的数据。此外还要注意，销售额有所增加。

当我们在之前的实验中创建的每个数据流按计划刷新时，数据就会被引入到 Lakehouse。Lakehouse 中的数据模型已更新，报表也已刷新。当每个数据流刷新时，我们不必刷新数据模型和报表。这是 Direct Lake 的优点。

我们来回顾一下问题陈述中列出的挑战：

- **您每天要刷新数据集至少 3 次，以适应不同数据源的不同更新时间。**

我们使用 Direct Lake 解决了这个问题。每个单独的数据流都按计划刷新。数据集和报表无需刷新。

- **刷新需要很长时间，因为您每次都需要完全刷新，以捕获源系统中的所有更新。**

我们仍然使用 Direct Lake 解决了这个问题。每个单独的数据流都按计划刷新。数据集和报表无需刷新，因此我们无需执行完全刷新。

- **用于提取数据的任何数据源中一旦发生任何错误，都将导致数据集刷新中断。很多时候，员工文件没有按时上传，导致数据集刷新中断。**

数据管道解决了这个问题，因为它能够在刷新失败时以不同时间间隔再次尝试刷新。

- **由于数据量大且转换复杂，对数据模型进行任何更改都需要很长时间，因为 Power Query 需要很长时间刷新预览。**

我们注意到，数据流不仅高效，而且方便更改。数据流中加载预览通常不需要很长时间。

- **您需要使用 Windows PC 才能使用 Power BI Desktop，但企业标配的是 Mac。**

Microsoft Fabric 是一种 SaaS 产品/服务。我们只需要使用浏览器来访问该服务即可。无需在桌面上安装任何软件。

# 清理实验环境

准备好清理实验环境后，请按照以下步骤操作。

1. 导航回到 **Power BI 画布**的浏览器选项卡。**关闭此选项卡。**

2. 导航到 **Lakehouse** **模型视图**的选项卡。

3. 从左侧面板中选择 **\<您的工作区名称\>** 以导航到主页。

4. 从顶部菜单中，选择"管理访问权限"旁边的**省略号 (...)**，然后选择**工作区设置**。

5. "工作区设置"对话框随即打开。从左侧菜单中选择**其他**。

6. 选择**删除此工作区**。

7. "删除工作区"对话框随即打开。选择**删除**。

这将删除工作区以及工作区中包含的所有项目。

# 参考

Fabric Analyst in a Day (FAIAD) 介绍了 Microsoft Fabric 中提供的一些主要功能。在服务菜单中，"帮助 (?)"部分包含指向一些优质资源的链接。

以下更多参考资源可帮助您进行与 Microsoft Fabric 相关的后续步骤。

- 请参阅博客文章以阅读完整的 [Microsoft Fabric GA 公告](https://aka.ms/Fabric-Hero-Blog-Ignite23)

- 通过[引导式教程](https://aka.ms/Fabric-GuidedTour)探索 Fabric

- 注册 [Microsoft Fabric 免费试用版](https://aka.ms/try-fabric)

- 访问 [Microsoft Fabric 网站](https://aka.ms/microsoft-fabric)

- 通过探索 [Fabric 学习模块](https://aka.ms/learn-fabric)学习新技能

- 探索 [Fabric 技术文档](https://aka.ms/fabric-docs)

- 阅读[有关 Fabric 入门指南的免费电子书](https://aka.ms/fabric-get-started-ebook)

- 加入 [Fabric 社区](https://aka.ms/fabric-community)发布问题、分享反馈并向他人学习

阅读更多深度 Fabric 体验公告博客：

- [Fabric 中的 Data Factory 体验博客](https://aka.ms/Fabric-Data-Factory-Blog) 

- [Fabric 中的 Synapse Data Engineering 体验博客](https://aka.ms/Fabric-DE-Blog) 

- [Fabric 中的 Synapse Data Science 体验博客](https://aka.ms/Fabric-DS-Blog) 

- [Fabric 中的 Synapse Data Warehousing 体验博客](https://aka.ms/Fabric-DW-Blog) 

- [Fabric 中的 Synapse Real-Time Analytics 体验博客](https://aka.ms/Fabric-RTA-Blog)

- [Power BI 公告博客](https://aka.ms/Fabric-PBI-Blog)

- [Fabric 中的 Data Activator 博客](https://aka.ms/Fabric-DA-Blog) 

- [Fabric 中的管理和治理博客](https://aka.ms/Fabric-Admin-Gov-Blog)

- [Fabric 中的 OneLake 博客](https://aka.ms/Fabric-OneLake-Blog)

- [Dataverse 和 Microsoft Fabric 集成博客](https://aka.ms/Dataverse-Fabric-Blog)

© 2023 Microsoft Corporation.保留所有权利。

使用此演示/实验即表示您已同意以下条款：

本演示/实验中的技术/功能由 Microsoft Corporation 出于获取反馈和提供学习体验的目的提供。只能将本演示/实验用于评估这些技术特性和功能以及向 Microsoft 提供反馈。不得用于任何其他用途。不得对此演示/实验或其任何部分进行修改、复制、分发、传送、显示、执行、复制、公布、许可、转让、销售或基于以上内容创建衍生作品。

严禁将本演示/实验（或其任何部分）复制到任何其他服务器或位置以便进一步复制或再分发。

本演示/实验出于上述目的，在不涉及复杂设置或安装操作的模拟环境中提供特定软件技术/产品特性和功能，包括潜在的新功能和概念。本演示/实验中展示的技术/概念可能不是完整的功能，可能会以不同于最终版本的工作方式工作。我们也可能不会发布此类功能或概念的最终版本。在物理环境中使用此类特性和功能的体验可能也有所不同。

**反馈**。如您针对本演示/实验中所述的技术特性、功能和/或概念向 Microsoft 提供反馈，则意味着您向 Microsoft 无偿提供以任何方式、出于任何目的使用和分享您的反馈并将其商业化的权利。您同样无偿为第三方提供其产品、技术和服务使用或配合使用包含此反馈的 Microsoft 软件或服务的任何特定部分所需的任何专利权。如果根据某项许可的规定，Microsoft 由于在其软件或文档中包含了您的反馈需要向第三方授予该软件或文档的许可，请不要提供这样的反馈。这些权利在本协议终止后继续有效。

对于本演示/实验，Microsoft Corporation 不提供任何明示、暗示或法定的保证和条件，包括有关适销性、针对特定目的的适用性、所有权和不侵权的所有保证和条件。对于使用本演示/实验产生的结果或输出内容的准确性，或者出于任何目的包含本演示/实验中的信息的适用性，Microsoft 不做任何保证或陈述。

**免责声明**

本演示/实验仅包含 Microsoft Power BI 的部分新功能和增强功能。在产品的后续版本中，部分功能可能有所更改。在本演示/实验中，可了解部分新功能，但并非全部新功能。

